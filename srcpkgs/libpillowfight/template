# Template file for 'libpillowfight'
pkgname=libpillowfight
version=0.3.0
revision=1
build_style=gnu-makefile
hostmakedepends="cmake python3 python3-wheel python3-nose"
makedepends="python3-setuptools_scm python3-devel"
case $XBPS_TARGET_MACHINE in
	x86_64*) depends+=" python3-pillow-simd" ;;
	*) depends+=" python3-Pillow" ;;
esac
checkdepends="flake8"
short_desc="Small library containing various image processing algorithms"
maintainer="idealist1508 <id1508-github@yahoo.com>"
license="GPL-2.0-only"
homepage="https://gitlab.gnome.org/World/OpenPaperwork/libpillowfight"
distfiles="https://gitlab.gnome.org/World/OpenPaperwork/libpillowfight/-/archive/${version}/libpillowfight-${version}.tar.bz2"
checksum=0f39a6b0099bf246e961e30ddb9d3c19e8f9460ee24fbfa5c463cda196209327

export CMAKE_OPTS="-DCMAKE_INSTALL_PREFIX=/usr"
export PIP_ARGS="--root=/usr"

pre_build() {
	cat > src/pillowfight/_version.h <<- EOF || die
		#define INTERNAL_PILLOWFIGHT_VERSION "$version"
	EOF
}
